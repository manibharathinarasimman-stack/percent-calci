<!-- ===== START: percent-of-a-number-calculator.html ===== -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Percent Of A Number Calculator</title>
<style>
  :root{
    --primary:#72337F; --secondary:#FFC412; --text:#000; --muted:#6b7280; --border:#ececec;
    --radius:14px; --shadow:0 8px 24px rgba(0,0,0,.08), 0 2px 8px rgba(0,0,0,.05);
    --focus:0 0 0 3px rgba(114,51,127,.18);
    --btn-grad:linear-gradient(135deg,#72337F 0%,#8a4fa0 50%,#FFC412 100%);
  }
  html,body{height:100%;margin:0;background:#fff;color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  *{box-sizing:border-box}

  /* SHELL: fits any host iframe size (350×350, 500×500, etc.) */
  .shell{position:relative; width:100%; height:100%; display:flex; flex-direction:column; overflow:hidden; background:#fff}

  /* Top logo (fixed inside header, never overlaps) */
  .logo-topbar{position:sticky; top:0; display:flex; justify-content:flex-end; align-items:center; gap:8px;
               padding:6px 10px; background:#fff; z-index:10; border-bottom:1px solid var(--border)}
  .brand-logo{max-width:130px; max-height:40px; object-fit:contain; display:block}

  /* Header text (kept minimal per feedback) */
  header{padding:8px 10px 6px}
  .title{margin:0; font-size:16px; color:var(--primary); font-weight:800}
  .sub{margin:2px 0 0; font-size:12px; color:var(--muted)}

  /* Scrollable main area (keeps everything visible in compact containers) */
  .content{flex:1 1 auto; overflow:auto; padding:8px 10px 64px; /* bottom pad for FAB */ }

  /* Section blocks without heavy cards (no separate backgrounds) */
  .section{padding:8px 0}
  .section+.section{border-top:1px dashed var(--border)}

  /* Inputs */
  label{display:block; font-size:12px; font-weight:800; margin:6px 0 4px}
  .row{display:grid; grid-template-columns:1fr 1fr; gap:8px}
  .field{display:flex; align-items:center; gap:8px; background:#fff; border:1px solid var(--border);
         border-radius:10px; padding:8px 10px; box-shadow:inset 0 1px 0 rgba(0,0,0,.03)}
  input[type="text"], select{border:0; outline:none; background:transparent; width:100%; font-size:14px; color:var(--text)}
  .field:focus-within{box-shadow:var(--focus), inset 0 1px 0 rgba(0,0,0,.04); border-color:#e6d4eb}
  .hint{font-size:11px; color:var(--muted)}

  /* Buttons */
  .controls{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
  .btn{border:0; border-radius:10px; padding:10px 12px; font-weight:800; color:#fff; cursor:pointer;
       background:var(--btn-grad); background-size:220% 220%;
       transition:transform .14s ease, box-shadow .14s ease, background-position 1.8s ease}
  .btn:hover{box-shadow:0 8px 18px rgba(114,51,127,.18); background-position:100% 0}
  .btn:active{transform:translateY(2px)}
  .btn.secondary{color:var(--primary); background:#fff; border:1px solid #eadff0}
  .btn.ghost{color:var(--primary); background:transparent; border:1px dashed #e6d4eb}
  @media (prefers-reduced-motion:reduce){ .btn{transition:transform .14s ease, box-shadow .14s ease} }

  /* Result */
  .result{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px; border:1px solid var(--border); border-radius:12px; background:#fff; margin-top:10px}
  .answer{font-size:20px; font-weight:800; color:var(--primary)}
  .error{display:none; color:#c0392b; font-weight:800; font-size:12px; margin-top:6px}

  /* Steps (IMPORTANT: no numbers inside <li>) */
  .steps .label{font-weight:800; font-size:12px; color:#111}
  .steps ol{margin:6px 0 0 18px; padding:0; font-size:12px}
  .steps li{margin:4px 0}

  /* Visual kept compact on desktop; auto-fits in fullscreen */
  .visual{margin-top:10px}
  .canvas-wrap{border:1px solid var(--border); border-radius:12px; background:#fff; box-shadow:var(--shadow); overflow:hidden}
  .canvas-wrap.small{height:120px}        /* compact (inside small containers) */
  .canvas-wrap.medium{height:220px}       /* fullscreen or larger view */
  canvas{display:block; width:100%; height:100%}
  .legend{display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:6px; font-size:11px; color:var(--muted)}
  .sw{display:inline-block; width:12px; height:12px; border-radius:3px; margin-right:6px}
  .sw.p{background:#72337F} .sw.s{background:#FFC412}

  /* FAB: Expand/Collapse – always visible & clickable */
  .fab{position:absolute; right:10px; bottom:10px; z-index:20}
  .fab .btn{width:44px; height:44px; border-radius:12px; display:grid; place-items:center; padding:0; font-size:20px}

  /* Numeric keyboard (appears only when input focused; closes automatically) */
  .kbd{position:absolute; left:6px; right:6px; bottom:58px; border:1px solid var(--border); border-radius:12px; background:#fff;
       box-shadow:var(--shadow); transform:translateY(16px); opacity:0; pointer-events:none; transition:opacity .18s ease, transform .18s ease; z-index:19}
  .kbd.open{transform:translateY(0); opacity:1; pointer-events:auto}
  .kbd-head{display:flex; align-items:center; justify-content:space-between; padding:8px 10px; border-bottom:1px solid var(--border)}
  .kbd-title{font-weight:800; color:var(--primary); font-size:12px}
  .kbd-close{border:0; background:transparent; font-size:16px; cursor:pointer; color:var(--primary); font-weight:800}
  .kbd-grid{display:grid; grid-template-columns:repeat(4,1fr); gap:6px; padding:8px}
  .kbd-grid button{padding:10px; border-radius:10px; border:1px solid #eee; background:#fafafa; font-weight:800; cursor:pointer}
  .kbd-grid button.primary{background:var(--btn-grad); color:#fff; border:0}

  /* Fullscreen mode (native) – expand canvas size a bit */
  :fullscreen .canvas-wrap{height:min(40vh,320px)}
  :fullscreen .legend{font-size:12px}

  /* Focus rings */
  button:focus-visible, input:focus-visible, select:focus-visible{outline:none; box-shadow:var(--focus)}
</style>
</head>
<body>
  <div class="shell" id="appShell" aria-label="Percent Of A Number Calculator">

    <!-- Top logo (fixed inside app) -->
    <div class="logo-topbar">
      <img class="brand-logo" alt="BrightChamps Logo"
           src="https://ik.imagekit.io/brightchamps/website/brightchamps_logo_colour.png">
    </div>

    <!-- Minimal header -->
    <header>
      <h1 class="title">Percent Of A Number</h1>
      <p class="sub">Compute P% of N with clear steps.</p>
    </header>

    <!-- Scrollable content area -->
    <div class="content" id="scrollArea">
      <!-- Inputs -->
      <section class="section" aria-label="Inputs">
        <div class="row">
          <div>
            <label for="percent">Percentage (P%)</label>
            <div class="field"><input id="percent" type="text" inputmode="decimal" placeholder="e.g., 25" value="25" aria-label="Percentage value"></div>
            <div class="hint">Enter percent, not decimal (e.g., 12.5)</div>
          </div>
          <div>
            <label for="number">Number (N)</label>
            <div class="field"><input id="number" type="text" inputmode="decimal" placeholder="e.g., 200" value="200" aria-label="Base number"></div>
            <div class="hint">Any real number</div>
          </div>
        </div>

        <div class="row" style="margin-top:6px">
          <div>
            <label for="precision">Display precision</label>
            <div class="field">
              <select id="precision" aria-label="Decimal precision">
                <option value="0">0</option><option value="1">1</option>
                <option value="2" selected>2</option><option value="3">3</option><option value="4">4</option>
              </select>
            </div>
          </div>
          <div style="display:flex; align-items:flex-end"><div class="hint"><b>Formula:</b> Result = (P ÷ 100) × N</div></div>
        </div>

        <div id="err" class="error" role="alert"></div>

        <div class="controls">
          <button class="btn" id="calcBtn" type="button" aria-label="Calculate">Calculate</button>
          <button class="btn secondary" id="sampleBtn" type="button">Sample</button>
          <button class="btn ghost" id="resetBtn" type="button">Reset</button>
          <button class="btn secondary" id="copyBtn" type="button">Copy</button>
        </div>

        <div class="result" aria-live="polite" aria-atomic="true">
          <div>
            <div class="hint">Answer</div>
            <div class="answer" id="answer">—</div>
          </div>
          <div class="hint" id="meta">—</div>
        </div>
      </section>

      <!-- Steps -->
      <section class="section steps" aria-label="Explanation">
        <div class="label">Step-by-step</div>
        <!-- IMPORTANT: no numbers inside each <li> (browser provides numbering) -->
        <ol id="stepsList">
          <li>Formula: Result = (P ÷ 100) × N</li>
          <li>Substitution</li>
          <li>Simplification</li>
          <li>Final Answer</li>
        </ol>
      </section>

      <!-- Visual (kept compact; at the bottom) -->
      <section class="section visual" aria-label="Visual">
        <div class="canvas-wrap small" id="canvasWrap">
          <canvas id="viz" width="960" height="540" aria-label="Part vs Whole"></canvas>
        </div>
        <div class="legend">
          <span><span class="sw p"></span>Part (P% of N)</span>
          <span><span class="sw s"></span>Whole (N)</span>
        </div>
      </section>
    </div>

    <!-- Expand/Collapse FAB (always visible) -->
    <div class="fab"><button class="btn" id="fsBtn" title="Expand / Collapse" aria-label="Toggle fullscreen">⛶</button></div>

    <!-- On-screen numeric keyboard (appears only on focus; auto-closes) -->
    <div class="kbd" id="kbd" aria-hidden="true">
      <div class="kbd-head">
        <div class="kbd-title">Numeric Keyboard</div>
        <button class="kbd-close" id="kbdClose" aria-label="Close keyboard">✕</button>
      </div>
      <div class="kbd-grid">
        <button>7</button><button>8</button><button>9</button><button class="primary" data-act="back">⌫</button>
        <button>4</button><button>5</button><button>6</button><button class="primary" data-act="ac">AC</button>
        <button>1</button><button>2</button><button>3</button><button>00</button>
        <button>0</button><button>.</button><button>000</button><button class="primary" data-act="enter">Enter</button>
      </div>
    </div>
  </div>

<script>
(function(){
  'use strict';

  const CONFIG = { precision: 2 };

  const qs=(s,el=document)=>el.querySelector(s);
  const shell=qs('#appShell');
  const scrollArea=qs('#scrollArea');
  const percentEl=qs('#percent'), numberEl=qs('#number'), precEl=qs('#precision');
  const calcBtn=qs('#calcBtn'), sampleBtn=qs('#sampleBtn'), resetBtn=qs('#resetBtn'), copyBtn=qs('#copyBtn');
  const errEl=qs('#err'), answerEl=qs('#answer'), metaEl=qs('#meta'), stepsList=qs('#stepsList');
  const fsBtn=qs('#fsBtn');
  const kbd=qs('#kbd'), kbdClose=qs('#kbdClose');
  const canvas=qs('#viz'), ctx=canvas.getContext('2d');
  const canvasWrap=qs('#canvasWrap');

  // Helpers
  const getPrecision=()=>Number.isFinite(+precEl.value)?+precEl.value:CONFIG.precision;
  const fmt=(n,p=getPrecision())=>{
    try{ return new Intl.NumberFormat(undefined,{maximumFractionDigits:p}).format(n); }
    catch{ return Number(n).toFixed(p); }
  };
  const parseNum=v=>{ const x=Number(String(v).trim().replace(/,/g,'')); return Number.isFinite(x)?x:NaN; };

  // Audio (tiny bells)
  let audioOK=true, audioCtx;
  const lazyCtx=()=>{ if(audioCtx) return audioCtx; try{ audioCtx=new (window.AudioContext||window.webkitAudioContext)(); }catch{ audioOK=false; } return audioCtx; };
  const bell=(type='tap')=>{
    if(!audioOK) return; const ctxA=lazyCtx(); if(!ctxA) return;
    const o=ctxA.createOscillator(), g=ctxA.createGain(); o.connect(g); g.connect(ctxA.destination);
    const t=ctxA.currentTime;
    if(type==='tap'){ o.type='triangle'; o.frequency.setValueAtTime(740,t); g.gain.setValueAtTime(.0001,t); g.gain.exponentialRampToValueAtTime(.08,t+.01); g.gain.exponentialRampToValueAtTime(.0001,t+.12); o.start(t); o.stop(t+.16); }
    else if(type==='success'){ o.type='sine'; o.frequency.setValueAtTime(660,t); g.gain.setValueAtTime(.0001,t); g.gain.exponentialRampToValueAtTime(.14,t+.02); g.gain.exponentialRampToValueAtTime(.0001,t+.26); o.start(t); o.stop(t+.30); }
    else{ o.type='sawtooth'; o.frequency.setValueAtTime(220,t); g.gain.setValueAtTime(.0001,t); g.gain.exponentialRampToValueAtTime(.12,t+.02); g.gain.exponentialRampToValueAtTime(.0001,t+.22); o.start(t); o.stop(t+.26); }
  };

  // Keyboard drawer
  let currentInput=null;
  function openKbd(){ kbd.classList.add('open'); kbd.setAttribute('aria-hidden','false'); }
  function closeKbd(){ kbd.classList.remove('open'); kbd.setAttribute('aria-hidden','true'); currentInput=null; }
  [percentEl,numberEl].forEach(inp=>{
    inp.addEventListener('focus',()=>{ currentInput=inp; openKbd(); bell('tap'); });
    inp.addEventListener('keydown',(e)=>{
      if(e.key==='Enter'){ e.preventDefault(); calculate(); closeKbd(); }
      if(e.key==='ArrowUp'||e.key==='ArrowDown'){ e.preventDefault(); stepValue(inp, e.key==='ArrowUp'?1:-1); }
    });
    inp.addEventListener('input', ()=>bell('tap'));
  });
  function stepValue(inp,dir){ const v=parseNum(inp.value)||0; inp.value=String(v+dir); }
  kbdClose.addEventListener('click', ()=>{ closeKbd(); bell('tap'); });
  kbd.addEventListener('click',(e)=>{
    const t=e.target; if(!(t instanceof HTMLButtonElement)) return;
    const act=t.getAttribute('data-act');
    if(act==='back'){ if(currentInput){ currentInput.value=currentInput.value.slice(0,-1); currentInput.focus(); bell('tap'); } return; }
    if(act==='ac'){ if(currentInput){ currentInput.value=''; currentInput.focus(); bell('tap'); } return; }
    if(act==='enter'){ calculate(); bell('success'); closeKbd(); return; }
    if(currentInput){ currentInput.value+=t.textContent; currentInput.focus(); bell('tap'); }
  });
  // Auto-close when clicking outside
  document.addEventListener('mousedown',(e)=>{
    if(!kbd.contains(e.target) && e.target!==currentInput && ![percentEl,numberEl].includes(e.target)) closeKbd();
  });

  // Calculate
  function clearErr(){ errEl.style.display='none'; errEl.textContent=''; }
  function showErr(msg){ errEl.textContent=msg; errEl.style.display='block'; bell('warn'); }

  function calculate(){
    clearErr();
    const P=parseNum(percentEl.value), N=parseNum(numberEl.value);
    if(!Number.isFinite(P) || !Number.isFinite(N)){ showErr('Please enter valid numbers for P and N.'); return; }

    const part=(P/100)*N;
    answerEl.textContent=fmt(part);
    metaEl.textContent=`${fmt(P,2)}% of ${fmt(N)} = ${fmt(part)}`;

    // Steps (no duplicate numbering inside <li>)
    const steps=[
      'Formula: Result = (P ÷ 100) × N',
      `Substitution: Result = (${P} ÷ 100) × ${N}`,
      `Simplification: (${P} ÷ 100) = ${P/100}`,
      `Final Answer: ${fmt(part)}`
    ];
    stepsList.innerHTML='';
    steps.forEach(s=>{ const li=document.createElement('li'); li.textContent=s; stepsList.appendChild(li); });

    drawVisual(N, part);
    bell('success');
  }

  // Visual (compact, bottom)
  function drawVisual(total, part){
    // choose compact size for small containers
    const inFs = !!document.fullscreenElement;
    canvasWrap.classList.toggle('small', !inFs);
    canvasWrap.classList.toggle('medium', inFs);

    // DPR fit
    const dpr=Math.max(1, window.devicePixelRatio||1);
    const rect=canvas.getBoundingClientRect();
    canvas.width=Math.max(300, Math.round(rect.width*dpr));
    canvas.height=Math.round(rect.height*dpr);
    ctx.setTransform(dpr,0,0,dpr,0,0);
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Gentle vertical grid
    ctx.strokeStyle='#EEE'; ctx.lineWidth=1;
    for(let x=0; x<canvas.width/dpr; x+=40){ ctx.beginPath(); ctx.moveTo(x+.5, 18.5); ctx.lineTo(x+.5, canvas.height/dpr-48.5); ctx.stroke(); }

    // baseline
    ctx.strokeStyle='#BBB'; ctx.lineWidth=1.5;
    ctx.beginPath(); ctx.moveTo(24.5, canvas.height/dpr-48.5); ctx.lineTo(canvas.width/dpr-24.5, canvas.height/dpr-48.5); ctx.stroke();

    // bar area
    const left=40, right=canvas.width/dpr-40, top=40, bottom=canvas.height/dpr-70;
    const w=right-left, h=bottom-top;

    // whole (N)
    roundRect(ctx,left,top,w,h,10,true,false,'#FFC41233');
    ctx.strokeStyle='#FFC412'; ctx.lineWidth=2; roundRect(ctx,left,top,w,h,10,false,true);

    // part
    const ratio=(!Number.isFinite(total)||total===0)?0:Math.max(0, Math.min(1, part/total));
    roundRect(ctx,left,top,w*ratio,h,10,true,false,'#72337F');

    // labels (avoid overlap with legend by keeping inside safe zone)
    ctx.fillStyle='#000'; ctx.font='12px system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif';
    ctx.fillText(`Whole (N) = ${fmt(total)}`, left, top-8);
    const pct = (!Number.isFinite(total)||total===0)?0:(part/total*100);
    ctx.fillText(`Part = ${fmt(part)} (${fmt(pct,2)}%)`, left, bottom+18);
  }
  function roundRect(c,x,y,w,h,r,fill,stroke,fillStyle){
    if(fillStyle){ c.fillStyle=fillStyle; }
    c.beginPath(); c.moveTo(x+r,y);
    c.arcTo(x+w,y,x+w,y+h,r); c.arcTo(x+w,y+h,x,y+h,r);
    c.arcTo(x,y+h,x,y,r); c.arcTo(x,y,x+w,y,r); c.closePath();
    if(fill) c.fill(); if(stroke) c.stroke();
  }

  // Buttons
  calcBtn.addEventListener('click', calculate);
  sampleBtn.addEventListener('click', ()=>{
    const S=[{p:25,n:200},{p:12.5,n:80},{p:7.2,n:450},{p:150,n:18}];
    const s=S[Math.floor(Math.random()*S.length)];
    percentEl.value=s.p; numberEl.value=s.n; bell('tap'); calculate();
  });
  resetBtn.addEventListener('click', ()=>{
    percentEl.value='25'; numberEl.value='200'; answerEl.textContent='—'; metaEl.textContent='—';
    stepsList.innerHTML='<li>Formula: Result = (P ÷ 100) × N</li><li>Substitution</li><li>Simplification</li><li>Final Answer</li>';
    bell('tap'); drawVisual(0,0);
  });
  copyBtn.addEventListener('click', ()=>{
    const txt=`P=${percentEl.value}% | N=${numberEl.value}\nResult: ${answerEl.textContent}`;
    navigator.clipboard?.writeText(txt).then(()=>bell('success')).catch(()=>bell('warn'));
  });
  [percentEl,numberEl,precEl].forEach(el=> el.addEventListener('change', calculate));
  window.addEventListener('resize', ()=> drawVisual(parseNum(numberEl.value), (parseNum(percentEl.value)/100)*parseNum(numberEl.value)));

  // Fullscreen toggle (works inside iframe)
  fsBtn.addEventListener('click', ()=>{
    if(!document.fullscreenElement){
      shell.requestFullscreen?.(); fsBtn.textContent='↩︎'; fsBtn.setAttribute('aria-label','Exit fullscreen');
    }else{
      document.exitFullscreen?.(); fsBtn.textContent='⛶'; fsBtn.setAttribute('aria-label','Enter fullscreen');
    }
  });
  document.addEventListener('fullscreenchange', ()=>{
    const inFs=!!document.fullscreenElement;
    fsBtn.textContent=inFs?'↩︎':'⛶';
    // Grow canvas a bit in fullscreen, shrink in compact
    drawVisual(parseNum(numberEl.value), (parseNum(percentEl.value)/100)*parseNum(numberEl.value));
  });
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && document.fullscreenElement){ document.exitFullscreen(); } });

  // QA self-tests (console only)
  function qa(){
    let pass=0,total=3;
    if(close((25/100)*200, 50)) pass++;
    if(close((12.5/100)*80, 10)) pass++;
    if(close((150/100)*18, 27)) pass++;
    console.log(`QA Passed ${pass}/${total}`);
  }
  const close=(a,b)=>Math.abs(a-b)<1e-9;

  // Init
  function init(){ qa(); calculate(); }
  init();
})();
</script>
</body>
</html>
<!-- ===== END: percent-of-a-number-calculator.html ===== -->
